"use strict";(self.webpackChunkcgmh_ctc_website=self.webpackChunkcgmh_ctc_website||[]).push([[158],{4158:(q,v,e)=>{e.r(v),e.d(v,{AdminModule:()=>V});var p=e(6895),u=e(2761),Z=e(9041),f=e(9602),d=e(6425),D=e(309),M=e(3086),L=e(8666),m=e(7579),h=e(2722),S=e(3900),l=e(4004),y=e(9841),A=e(8505),$=e(8675),T=e(8372),R=e(1884),x=e(515),w=e(8746),I=e(262),U=e(7482),J=e(9577),E=e(6415),t=e(4650),F=e(4367),O=e(315),C=e(7331),Q=e(1572),b=e(682),B=e(901),N=e(9628);function Y(n,o){1&n&&(t.TgZ(0,"mat-chip",18),t._uU(1,"\u7a7a\u9593\u9810\u7d04"),t.qZA())}function j(n,o){1&n&&(t.TgZ(0,"mat-chip",19),t._uU(1,"\u8ab2\u7a0b\u5831\u540d"),t.qZA())}function H(n,o){if(1&n&&(t.TgZ(0,"li",11)(1,"div",12),t._UZ(2,"app-datetime-span",13),t.qZA(),t.TgZ(3,"div",14),t._uU(4),t.qZA(),t.TgZ(5,"mat-chip-list",15),t.YNc(6,Y,2,0,"mat-chip",16),t.YNc(7,j,2,0,"mat-chip",17),t.qZA()()),2&n){const s=o.$implicit;t.xp6(2),t.Q6J("start",s.startDatetime)("end",s.endDatetime),t.xp6(2),t.hij(" ",s.name," "),t.xp6(1),t.Q6J("selectable",!1),t.xp6(1),t.Q6J("ngIf","rsvn"===s.type),t.xp6(1),t.Q6J("ngIf","appl"===s.type)}}function z(n,o){1&n&&(t.TgZ(0,"li",20),t._uU(1," \u67e5\u7121\u5831\u540d\u6216\u9810\u7d04 "),t.qZA())}function P(n,o){1&n&&(t.TgZ(0,"div",21),t._UZ(1,"mat-spinner"),t.qZA())}const G=[{path:"",component:(()=>{class n{constructor(s,a,i){this.route=s,this.resourcesService=a,this.snackBarService=i,this.destroy$=new m.x,this.viewInit$=new m.x,this.calendarHeader=U.$,this.now=new Date,this.selectedDate=null,this.yearAndMonth$=new m.x,this.dateFilter=r=>!1,this.dateClass=(r,g)=>"month"!==g?"":this.startDateSet.has((0,d.Z)(r,"yyyy/MM/dd"))?"bg-warn font-medium border-2 border-solid border-white rounded-full":"",this.eventList$=new m.x,this.startDateSet=new Set,this.gettingApplList=!1,this.gettingRsvnList=!1;const{resourceList:c}=this.route.snapshot.data;this.resourceNameMap=(0,E.J)(c,"seq","name"),this.yearAndMonth$.pipe((0,h.R)(this.destroy$),(0,S.w)(r=>this.fetchEventList(r)),(0,l.U)(r=>{this.eventList$.next(r)})).subscribe(),(0,y.a)([this.viewInit$,this.eventList$]).pipe((0,h.R)(this.destroy$),(0,l.U)(([r,g])=>new Set(g.map(W=>(0,d.Z)(new Date(W.startDatetime),"yyyy/MM/dd")))),(0,A.b)(r=>{this.startDateSet=r,this.calendar.updateTodaysDate()})).subscribe()}ngOnInit(){}ngAfterViewInit(){this.viewInit$.next(null),this.viewInit$.complete(),this.calendar.stateChanges.pipe((0,h.R)(this.destroy$),(0,$.O)(null),(0,T.b)(300),(0,l.U)(()=>(0,d.Z)(this.calendar.activeDate,"yyyy/MM")),(0,R.x)(),(0,A.b)(s=>{this.yearAndMonth$.next(s)})).subscribe()}fetchEventList(s){return(0,y.a)([this.fetchRsvnList(s)]).pipe((0,l.U)(([a])=>[...a.map(i=>({seq:i.seq,startDatetime:i.startDatetime,endDatetime:i.endDatetime,name:this.resourceNameMap[""+i.resourceSeq],type:"rsvn"}))]),(0,l.U)(a=>a.sort((i,c)=>new Date(i.startDatetime).valueOf()-new Date(c.startDatetime).valueOf())))}fetchRsvnList(s){if(this.gettingRsvnList)return x.E;this.gettingRsvnList=!0;const a=(0,D.Z)(`${s}/01`,"yyyy/MM/dd",new Date),i=(0,M.Z)((0,L.Z)(a,{months:1}),{days:1}),c={resourceSeq:4,minStartDate:(0,d.Z)(a,"yyyy/MM/dd"),maxStartDate:(0,d.Z)(i,"yyyy/MM/dd")};return this.resourcesService.GetRsvnList(c).pipe((0,h.R)(this.destroy$),(0,w.x)(()=>this.gettingRsvnList=!1),(0,l.U)(r=>r.content),(0,I.K)(r=>this.onError(r)))}onError(s){return console.error(s),this.snackBarService.add({message:s.message,type:J.K.Error}),x.E}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}}return n.\u0275fac=function(s){return new(s||n)(t.Y36(u.gz),t.Y36(F.X),t.Y36(O.c))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-account"]],viewQuery:function(s,a){if(1&s&&t.Gf(f._H,5),2&s){let i;t.iGM(i=t.CRH())&&(a.calendar=i.first)}},decls:13,vars:11,consts:[["title","\u6703\u54e1\u5c08\u5340","engTitle","Account"],["id","account-section",1,"spinner-box","p-page-padding"],[1,"w-page","flex","flex-wrap"],[1,"w-full","shrink-0","flex","justify-center","mb-4","md:w-80","md:mr-8","md:mb-0","lg:w-120"],[1,"w-120","max-w-full","m-auto"],[3,"headerComponent","dateFilter","dateClass","selected","selectedChange"],[1,"w-full","grow","md:w-auto"],[1,"grid","grid-cols-1","gap-8","mb-8"],["class","col-span-1 bg-white rounded-lg shadow-lg p-4 cursor-pointer hover:bg-primary-300 hover:bg-opacity-10 hover:-translate-x-[2px] hover:-translate-y-[2px]",4,"ngFor","ngForOf"],["class","col-span-1 h-40 flex justify-center items-center",4,"ngIf"],["class","spinner",4,"ngIf"],[1,"col-span-1","bg-white","rounded-lg","shadow-lg","p-4","cursor-pointer","hover:bg-primary-300","hover:bg-opacity-10","hover:-translate-x-[2px]","hover:-translate-y-[2px]"],[1,"font-medium","text-sm","mb-2"],[3,"start","end"],[1,"h-12","text-base","line-clamp-2","mb-2"],[3,"selectable"],["class","bg-accent text-white","appStopClickPropagation","",4,"ngIf"],["class","bg-primary text-white","appStopClickPropagation","",4,"ngIf"],["appStopClickPropagation","",1,"bg-accent","text-white"],["appStopClickPropagation","",1,"bg-primary","text-white"],[1,"col-span-1","h-40","flex","justify-center","items-center"],[1,"spinner"]],template:function(s,a){if(1&s&&(t._UZ(0,"app-page-cover",0),t.TgZ(1,"section",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-calendar",5),t.NdJ("selectedChange",function(c){return a.selectedDate=c}),t.qZA()()(),t.TgZ(6,"div",6)(7,"ul",7),t.YNc(8,H,8,6,"li",8),t.ALo(9,"async"),t.YNc(10,z,2,0,"li",9),t.ALo(11,"async"),t.qZA()()(),t.YNc(12,P,2,0,"div",10),t.qZA()),2&s){let i;t.xp6(5),t.Q6J("headerComponent",a.calendarHeader)("dateFilter",a.dateFilter)("dateClass",a.dateClass)("selected",a.selectedDate),t.xp6(3),t.Q6J("ngForOf",t.lcZ(9,7,a.eventList$)),t.xp6(2),t.Q6J("ngIf",!(a.gettingApplList||a.gettingRsvnList||null!=(i=t.lcZ(11,9,a.eventList$))&&i.length)),t.xp6(2),t.Q6J("ngIf",a.gettingApplList||a.gettingRsvnList)}},dependencies:[p.sg,p.O5,C.qn,C.HS,f._H,Q.Ou,b.P,B._,N.M,p.Ov]}),n})(),pathMatch:"full",resolve:{resourceList:Z.L}}];let K=(()=>{class n{}return n.\u0275fac=function(s){return new(s||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.Bz.forChild(G),u.Bz]}),n})();var X=e(1910);let V=(()=>{class n{}return n.\u0275fac=function(s){return new(s||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.ez,K,X.m]}),n})()}}]);